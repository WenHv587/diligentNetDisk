## NetDisk
- 简介：一个简单的网盘。后台使用SSM框架，前端主要使用Bootstrap + jQuery 搭建渲染页面，前后端的交互主要以ajax为主。实现了分类别、分用户存放文件，预览文件，下载暂停断点等。

### 整体思路
- 数据库设计三张表
  - 用户表。用来存储用户的信息。
    - 用户有两种状态，0代表非会员，1代表会员。会员和非会员用之间存在区别对待，比如会员用户空间容量大，且会员用户可上传的单文件大小限制也比普通会员大。
  - 类别表。存储文件的类别（这张表一般不会发生变动，主要是用于让文件表去关联）。
  - 文件表。存储文件的信息，分别关联用户表和类别表，以确定文件的类别和上传者。
    
    - 文件有三种状态：初始状态，共享状态和回收站状态。 通过数据库中可以简单的区分。（我的实现是，0代表正常文件；s_加日期代表共享状态，同时还能带上共享文件的时间；d\_加日期代表回收站状态，日期可以代表删除时间）
- 使用SSM框架
- 全部使用ajax请求

---
### 主要功能介绍
- 登录/注册
  - 登录和注册分别写了两个页面。登录和注册都有双重的校验，首先是用户输入逻辑的校验，是否满足格式、长度等要求。还有数据合理性方面的校验，比如用户名，邮箱是否发生重复等。
  - 注册写了一个验证码功能，防止恶意注册。注册成功以后，会为每个新用户在指定位置创建一个以用户名命名的文件夹，用来存放这个用户的所有文件，并跳转到登录界面。登录成功以后，会将用户的信息存到session中，并跳转到网盘的主界面。

- 退出
  
  - 将session设置为失效，并返回到登录界面。
  
- 上传文件
  - 使用SpringMVC上传文件的方式（MultipartFile）。在上传文件时，会对文件的大小进行判断，限制用户上传文件的大小，并且区别会员用户和非会员用户。
  - 上传文件遇到重名情况时，写了一个递归方法自动修改文件的名称，保证文件不重复且不被覆盖。

- 下载文件
  
  - 因为写的网盘是B/S类型，所以使用了ResponseEntity来下载文件，通过浏览器进行下载。本来是想自己写一个下载，来实现简单的断点续传（在上次任务中我写的多线程下载文件就写了一个简易版的断点续传），但是感觉通过浏览器下载比自己下载，再去输入存放路径方便得多，而且下载时暂停也很方便，大多数浏览器都支持断点续传，所以感觉用浏览器下载是更好的选择。
  
- 共享文件
  - 将文件的状态设置为指定的格式，文件就变成了公开状态，可以供其他用户下载。（实现了批量共享）
  
- 取消共享
  - 将文件的状态设置为普通。  
  
- 删除文件
  - 这里的删除是指将文件放入回收站，也是通过修改文件的状态来实现。（实现了批量删除）
  
- 恢复文件
  - 进入回收站进行恢复，将文件的状态设置为普通。
  
- 彻底删除文件
  - 进入回收站删除，在数据库和服务器上删除彻底文件。（实现了清空回收站）
  
- 修改文件名称
  - 在文件列表中可以对文件名称进行修改，会做重复性校验。
  
- 开通会员功能
  - 给用户提供的邮箱中发送一封开通会员的邮件。使用JavaMail实现，点击邮件中的连接即可一键开通会员。

- 预览文件功能
  - 预览图片文件。直接提供一个超链接请求后台数据，并打开一个新窗口，将图片写出到页面上。
  - 预览本文文件。使用到了pdf.js + OpenOffice。通过OpenOffice将各种类型的文本文件转换成pdf格式，然后打开一个新窗口，使用pdf.js在浏览器中打开显示pdf。使用OpenOffice主要是想实现预览Office文件，实现方法主流就是将文件转成pdf再在浏览器中打开。使用pdf.js主要是感觉这种方式的显示效果比较美观方便。

---

### 总结
- 此次任务给的实现比较长，在写代码的过程中，遇到的问题也很多。由于是第一次正式的用SSM写一个东西，所以很多业务不是很熟练，而且说实话，由于对前端不是很熟练，导致前端出错去调试花的时间可能比后端花的还要多，所以感觉很有必要花时间学一下vue。
- 写了很多功能，但是大多数都是普通的业务功能，核心的功能不是很满意，之前很想写一个上传进度条，还是限制在前端界面不知道怎么写。
- 总的来说，这次任务是我第一次用SSM写一个东西，很多东西都是在边学习边使用，有很多不完善的地方，还需要不断地学习新知识来改善。



